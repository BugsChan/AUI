(function(x,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(x=typeof globalThis<"u"?globalThis:x||self,e(x.AUI={},x.Vue))})(this,(function(x,e){"use strict";var C=document.createElement("style");C.textContent=`.aui-icon-container[data-v-4e02fcf6]{position:fixed;cursor:pointer;z-index:10000;display:flex;align-items:center;justify-content:center;transition:all .3s ease}.aui-icon-top-left[data-v-4e02fcf6]{top:20px;left:20px}.aui-icon-top-right[data-v-4e02fcf6]{top:20px;right:20px}.aui-icon-bottom-left[data-v-4e02fcf6]{bottom:20px;left:20px}.aui-icon-bottom-right[data-v-4e02fcf6]{bottom:20px;right:20px}.aui-icon-bottom-center[data-v-4e02fcf6]{bottom:20px;left:50%;transform:translate(-50%)}.aui-icon-img[data-v-4e02fcf6]{border-radius:50%;box-shadow:0 2px 10px #0000001a;transition:all .3s ease}.aui-icon-default[data-v-4e02fcf6]{width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:16px;box-shadow:0 2px 10px #0000001a;transition:all .3s ease}.aui-icon-container:hover .aui-icon-img[data-v-4e02fcf6],.aui-icon-container:hover .aui-icon-default[data-v-4e02fcf6]{transform:scale(1.1);box-shadow:0 4px 15px #0003}.aui-icon-tooltip[data-v-4e02fcf6]{position:absolute;bottom:100%;left:50%;transform:translate(-50%);background:#000c;color:#fff;padding:4px 8px;border-radius:4px;font-size:12px;margin-bottom:8px;white-space:nowrap;opacity:0;transition:opacity .3s ease;pointer-events:none}.aui-icon-container:hover .aui-icon-tooltip[data-v-4e02fcf6]{opacity:1}@media(max-width:768px){.aui-icon-container[data-v-4e02fcf6]{bottom:20px!important}.aui-icon-bottom-center[data-v-4e02fcf6]{left:50%!important;transform:translate(-50%)!important}.aui-icon-img[data-v-4e02fcf6]{width:calc(var(--icon-width, 32px) * 1.5)!important;height:calc(var(--icon-height, 32px) * 1.5)!important}.aui-icon-default[data-v-4e02fcf6]{width:calc(var(--icon-width, 32px) * 1.5)!important;height:calc(var(--icon-height, 32px) * 1.5)!important;font-size:24px!important}}.aui-window-container[data-v-a23157d9]{position:fixed;background:#fff;border-radius:8px;box-shadow:0 4px 20px #00000026;z-index:10001;display:flex;flex-direction:column;transition:all .3s ease;overflow:hidden;box-sizing:border-box}.aui-window-header[data-v-a23157d9]{background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:#fff;padding:10px 15px;display:flex;justify-content:space-between;align-items:center;cursor:move;-webkit-user-select:none;user-select:none}.aui-window-title[data-v-a23157d9]{font-size:14px;font-weight:700}.aui-window-close[data-v-a23157d9]{background:none;border:none;color:#fff;font-size:20px;cursor:pointer;padding:0;width:20px;height:20px;display:flex;align-items:center;justify-content:center;border-radius:50%;transition:background-color .2s}.aui-window-close[data-v-a23157d9]:hover{background-color:#fff3}.aui-window-mobile[data-v-a23157d9]{bottom:0!important;left:0!important;right:0!important;width:100%!important;border-radius:16px 16px 0 0!important;height:calc(100vh / 3)!important;min-height:400px!important;max-height:600px!important;transform:none!important;box-sizing:border-box!important}.aui-window-header-mobile[data-v-a23157d9]{background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:#fff;padding:12px 16px;display:flex;justify-content:space-between;align-items:center;border-radius:16px 16px 0 0}.aui-window-content[data-v-a23157d9]{flex:1;padding:15px;overflow-y:auto;background-color:#f8f9fa}.aui-messages[data-v-a23157d9]{display:flex;flex-direction:column;gap:10px}.aui-message[data-v-a23157d9]{max-width:80%;padding:8px 12px;border-radius:18px;margin-bottom:10px}.aui-message.system[data-v-a23157d9]{align-self:center;background-color:#e9ecef;color:#495057;font-size:12px}.aui-message.user[data-v-a23157d9]{align-self:flex-end;background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:#fff}.aui-message.ai[data-v-a23157d9]{align-self:flex-start;background-color:#fff;border:1px solid #e9ecef}.aui-message-content[data-v-a23157d9]{word-wrap:break-word;font-size:14px}.aui-card-container[data-v-a23157d9]{margin:10px 0;background-color:transparent;padding:0;box-shadow:none;border-radius:0}.aui-card-wrapper[data-v-a23157d9]{margin:10px 0}.aui-window-input-container[data-v-a23157d9]{padding:10px;background-color:#fff;border-top:1px solid #e9ecef}.aui-input-wrapper[data-v-a23157d9]{display:flex;align-items:center;gap:8px;background-color:#f8f9fa;padding:6px 12px;border-radius:18px}.aui-voice-btn[data-v-a23157d9]{background:none;border:none;font-size:16px;cursor:pointer;padding:6px;border-radius:50%;transition:background-color .2s}.aui-voice-btn[data-v-a23157d9]:hover{background-color:#0000001a}.aui-input[data-v-a23157d9]{flex:1;border:none;background:transparent;outline:none;font-size:14px;padding:6px 0;margin:0 6px}.aui-send-btn[data-v-a23157d9]{background:linear-gradient(135deg,#3b82f6,#1d4ed8);border:none;color:#fff;width:60px;height:30px;border-radius:15px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:13px;transition:all .2s ease}.aui-send-btn[data-v-a23157d9]:hover{transform:scale(1.1)}.aui-card-container[data-v-a23157d9]{margin:10px 0;background-color:#fff;border-radius:8px;padding:15px;box-shadow:0 2px 8px #0000001a}.aui-loading[data-v-a23157d9]{display:flex;align-items:center;gap:6px;padding:4px 0}.aui-loading-dot[data-v-a23157d9]{width:8px;height:8px;background-color:#3b82f6;border-radius:50%;animation:loading-pulse-a23157d9 1.4s infinite ease-in-out}.aui-loading-dot[data-v-a23157d9]:nth-child(2){animation-delay:.2s}.aui-loading-dot[data-v-a23157d9]:nth-child(3){animation-delay:.4s}@keyframes loading-pulse-a23157d9{0%,80%,to{transform:scale(0);opacity:.5}40%{transform:scale(1);opacity:1}}.aui-window-content[data-v-a23157d9]::-webkit-scrollbar{width:6px}.aui-window-content[data-v-a23157d9]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.aui-window-content[data-v-a23157d9]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.aui-window-content[data-v-a23157d9]::-webkit-scrollbar-thumb:hover{background:#a1a1a1}.aui-card[data-v-21017ea7]{background:#fff;border-radius:8px;padding:12px;box-shadow:0 2px 8px #0000001a;display:flex;flex-direction:column;gap:8px;position:relative}.aui-card-attention[data-v-21017ea7]{font-size:14px;color:#666;text-align:left;margin-bottom:4px;font-weight:500}.aui-card-image-container[data-v-21017ea7]{display:flex;justify-content:center;align-items:center;margin:4px 0;min-height:80px;background-color:#f8f9fa;border-radius:4px;overflow:hidden;border:1px dashed #dee2e6}.aui-card-image[data-v-21017ea7]{max-width:100%;max-height:200px;object-fit:contain}.aui-card-svg[data-v-21017ea7]{max-width:100%;max-height:200px;display:flex;justify-content:center;align-items:center}.aui-card-svg svg[data-v-21017ea7]{max-width:100%;max-height:200px;object-fit:contain}.aui-card-image-placeholder[data-v-21017ea7]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;color:#adb5bd}.aui-placeholder-icon[data-v-21017ea7]{font-size:32px;margin-bottom:8px}.aui-placeholder-text[data-v-21017ea7]{font-size:14px}.aui-card-inputs[data-v-21017ea7]{display:flex;flex-direction:column;gap:8px;margin:4px 0}.aui-input-group[data-v-21017ea7]{display:flex;flex-direction:column;gap:4px}.aui-input-label[data-v-21017ea7]{font-size:12px;color:#666;font-weight:500}.aui-card-input[data-v-21017ea7]{padding:8px 12px;border:1px solid #e9ecef;border-radius:4px;font-size:14px;outline:none;transition:border-color .2s}.aui-card-input[data-v-21017ea7]:focus{border-color:#667eea;box-shadow:0 0 0 2px #667eea33}.aui-journey-inputs[data-v-21017ea7]{display:flex;flex-direction:column;gap:8px}.aui-journey-arrow[data-v-21017ea7]{text-align:center;font-size:20px;color:#667eea;margin:4px 0}.aui-card-actions[data-v-21017ea7]{display:flex;justify-content:flex-end;margin-top:4px}.aui-card-confirm[data-v-21017ea7]{background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:#fff;border:none;padding:6px 16px;border-radius:16px;font-size:12px;font-weight:500;cursor:pointer;transition:transform .2s,box-shadow .2s;min-width:60px}.aui-card-confirm[data-v-21017ea7]:hover{transform:translateY(-1px);box-shadow:0 2px 8px #3b82f64d}.aui-card-confirm[data-v-21017ea7]:active{transform:translateY(0)}.aui-main-container[data-v-37169f37]{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:9999}.aui-main-container[data-v-37169f37] .aui-icon-container,.aui-main-container[data-v-37169f37] .aui-window-container{pointer-events:auto}
/*$vite$:1*/`,document.head.appendChild(C);const v=(n,i)=>{const s=n.__vccOpts||n;for(const[r,t]of i)s[r]=t;return s},$=["src","alt"],z={key:2,class:"aui-icon-tooltip"},M=v({__name:"aui-icon",props:{iconConfig:{type:Object,default:()=>({path:"",width:32,height:32,position:"bottom-right",description:""})}},emits:["click"],setup(n,{emit:i}){const s=n,r=i,t=e.computed(()=>{const f=window.innerWidth<=768;let l=s.iconConfig.position||"bottom-right";return f&&(l=s.iconConfig.position||"bottom-center"),`aui-icon-${l}`}),c=()=>{r("click")};return(f,l)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["aui-icon-container",t.value]),onClick:c,style:e.normalizeStyle({"--icon-width":`${n.iconConfig.width||32}px`,"--icon-height":`${n.iconConfig.height||32}px`})},[n.iconConfig.path?(e.openBlock(),e.createElementBlock("img",{key:0,src:n.iconConfig.path,alt:n.iconConfig.description||"AI Assistant",style:e.normalizeStyle({width:`${n.iconConfig.width||32}px`,height:`${n.iconConfig.height||32}px`}),class:"aui-icon-img"},null,12,$)):(e.openBlock(),e.createElementBlock("div",{key:1,class:"aui-icon-default",style:e.normalizeStyle({width:`${n.iconConfig.width||32}px`,height:`${n.iconConfig.height||32}px`})}," AI ",4)),n.iconConfig.description?(e.openBlock(),e.createElementBlock("div",z,e.toDisplayString(n.iconConfig.description),1)):e.createCommentVNode("",!0)],6))}},[["__scopeId","data-v-4e02fcf6"]]),L={class:"aui-window-title"},I={key:1,class:"aui-window-header-mobile"},S={class:"aui-window-title"},A={class:"aui-messages"},j={class:"aui-message-content"},T={key:1},D={key:0,class:"aui-message ai"},R={class:"aui-window-input-container"},P={class:"aui-input-wrapper"},O=["placeholder"],W=v({__name:"aui-win",props:{visible:{type:Boolean,default:!1},windowConfig:{type:Object,default:()=>({width:300,height:400,position:"bottom-right",description:"",placeholder:""})}},emits:["close","send-message"],setup(n,{expose:i,emit:s}){const r=n,t=s,c=e.ref(null),f=e.ref(null),l=e.ref(!1),g=e.ref(""),b=e.ref(!1),a=e.ref([]),o=e.ref(!1),d=e.ref(!1),u=e.ref({x:0,y:0}),m=e.ref({x:0,y:0});e.onMounted(()=>{V(),window.addEventListener("resize",V),window.addEventListener("mousemove",se),window.addEventListener("mouseup",ce)});const V=()=>{l.value=window.innerWidth<=768,l.value?m.value={x:0,y:0}:m.value={x:window.innerWidth-(r.windowConfig.width||300)-40,y:window.innerHeight-(r.windowConfig.height||400)-100}},de=e.computed(()=>{const p={};return l.value?(p.width="100%",p.height="300px"):(p.width=`${r.windowConfig.width||300}px`,p.height=`${r.windowConfig.height||400}px`,p.left=`${m.value.x}px`,p.top=`${m.value.y}px`),p}),re=p=>{l.value||(d.value=!0,u.value={x:p.clientX-m.value.x,y:p.clientY-m.value.y})},se=p=>{!d.value||l.value||(m.value={x:p.clientX-u.value.x,y:p.clientY-u.value.y})},ce=()=>{d.value=!1},B=()=>{t("close")},le=p=>{a.value.push({type:"message",sender:"ai",content:p}),o.value=!1,e.nextTick(()=>{y()})},pe=(p,w={})=>{const h={...p,_params:w};a.value.push({type:"card",data:h}),o.value=!1,e.nextTick(()=>{y()})},N=()=>{if(!g.value.trim())return;a.value.push({type:"message",sender:"user",content:g.value}),o.value=!0;const p=g.value;g.value="",e.nextTick(()=>{y()}),t("send-message",p)},fe=()=>{},ue=p=>{console.log("Card confirmed:",p)},y=()=>{f.value&&(f.value.scrollTop=f.value.scrollHeight)};return e.watch(a,()=>{e.nextTick(()=>{y()})}),e.watch(o,()=>{e.nextTick(()=>{y()})}),i({replyMessage:le,replyCard:pe}),(p,w)=>n.visible?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["aui-window-container",{"aui-window-mobile":l.value}]),style:e.normalizeStyle(de.value),ref_key:"windowRef",ref:c},[l.value?(e.openBlock(),e.createElementBlock("div",I,[e.createElementVNode("div",S,e.toDisplayString(n.windowConfig.description||"AI Assistant"),1),e.createElementVNode("button",{class:"aui-window-close",onClick:B},"Ã—")])):(e.openBlock(),e.createElementBlock("div",{key:0,class:"aui-window-header",onMousedown:re},[e.createElementVNode("div",L,e.toDisplayString(n.windowConfig.description||"AI Assistant"),1),e.createElementVNode("button",{class:"aui-window-close",onClick:B},"Ã—")],32)),e.createElementVNode("div",{class:"aui-window-content",ref_key:"contentRef",ref:f},[e.createElementVNode("div",A,[w[2]||(w[2]=e.createElementVNode("div",{class:"aui-message system"},[e.createElementVNode("div",{class:"aui-message-content"}," ä½ å¥½ï¼æˆ‘æ˜¯AIåŠ©æ‰‹ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ ")],-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value,(h,me)=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:me},[h.type==="message"?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["aui-message",h.sender])},[e.createElementVNode("div",j,e.toDisplayString(h.content),1)],2)):h.type==="card"?(e.openBlock(),e.createElementBlock("div",T,[e.renderSlot(p.$slots,"card",{card:h.data,onConfirm:ue},void 0,!0)])):e.createCommentVNode("",!0)],64))),128)),o.value?(e.openBlock(),e.createElementBlock("div",D,[...w[1]||(w[1]=[e.createStaticVNode('<div class="aui-message-content" data-v-a23157d9><div class="aui-loading" data-v-a23157d9><div class="aui-loading-dot" data-v-a23157d9></div><div class="aui-loading-dot" data-v-a23157d9></div><div class="aui-loading-dot" data-v-a23157d9></div></div></div>',1)])])):e.createCommentVNode("",!0)])],512),e.createElementVNode("div",R,[e.createElementVNode("div",P,[e.createElementVNode("button",{class:"aui-voice-btn",onClick:fe},e.toDisplayString(b.value?"ðŸ”´":"ðŸŽ¤"),1),e.withDirectives(e.createElementVNode("input",{type:"text",class:"aui-input",placeholder:n.windowConfig.placeholder||"è¯·è¾“å…¥æ‚¨çš„é—®é¢˜...","onUpdate:modelValue":w[0]||(w[0]=h=>g.value=h),onKeyup:e.withKeys(N,["enter"])},null,40,O),[[e.vModelText,g.value]]),e.createElementVNode("button",{class:"aui-send-btn",onClick:N}," âž¤ ")])])],6)):e.createCommentVNode("",!0)}},[["__scopeId","data-v-a23157d9"]]),U={class:"aui-card-attention"},H={class:"aui-card-image-container"},q=["innerHTML"],F=["src"],K={key:2,class:"aui-card-image-placeholder"},Y={class:"aui-card-inputs"},J=["for"],X=["id","onUpdate:modelValue","placeholder"],G={key:1,class:"aui-journey-inputs"},Q={class:"aui-input-group"},Z={class:"aui-input-group"},ee=v({__name:"aui-card",props:{cardConfig:{type:Object,required:!0,default:()=>({description:"",method:null,params:[],ui:{type:"button",cardImg:null,attention:""}})}},emits:["confirm"],setup(n,{emit:i}){const s=n,r=i,t=e.ref({}),c=e.computed(()=>{const a=s.cardConfig.ui;return typeof a=="function"?a():a||{type:"button",cardImg:null,attention:""}});e.watch(()=>s.cardConfig,a=>{if(a.params){const o={},d=a._params||{};a.params.forEach(u=>{o[u.name]=d[u.name]!==void 0?d[u.name]:""}),t.value=o}},{immediate:!0,deep:!0});const f=a=>typeof a=="string"&&(a.trim().startsWith("<svg")||a.trim().startsWith("data:image/svg+xml")),l=e.computed(()=>{const a=c.value.cardImg;if(!a)return null;if(a.startsWith("$")){const o=a.slice(1);return t.value[o]||null}return a}),g=e.computed(()=>{const a=l.value;return a?f(a):!1}),b=()=>{const a=[];if(console.log(s.cardConfig),c.value.type==="journey"){const o=c.value.start||"start",d=c.value.end||"end";a.push(t.value[o],t.value[d])}else s.cardConfig.params&&s.cardConfig.params.forEach(o=>{a.push(t.value[o.name])});r("confirm",{method:s.cardConfig.method,params:a,paramValues:t.value})};return(a,o)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["aui-card",c.value.type])},[e.createElementVNode("div",U,e.toDisplayString(c.value.attention||"è¯·ç¡®è®¤æ“ä½œ"),1),e.createElementVNode("div",H,[g.value?(e.openBlock(),e.createElementBlock("div",{key:0,class:"aui-card-svg",innerHTML:l.value},null,8,q)):l.value?(e.openBlock(),e.createElementBlock("img",{key:1,src:l.value,alt:"Card Image",class:"aui-card-image"},null,8,F)):(e.openBlock(),e.createElementBlock("div",K,[...o[2]||(o[2]=[e.createElementVNode("div",{class:"aui-placeholder-icon"},"ðŸ“·",-1),e.createElementVNode("div",{class:"aui-placeholder-text"},"æš‚æ— å›¾ç‰‡",-1)])]))]),e.createElementVNode("div",Y,[c.value.type==="input"?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(n.cardConfig.params.filter(d=>!d.hidden),(d,u)=>(e.openBlock(),e.createElementBlock("div",{key:u,class:"aui-input-group"},[e.createElementVNode("label",{for:"param-"+u,class:"aui-input-label"},e.toDisplayString(d.description),9,J),e.withDirectives(e.createElementVNode("input",{id:"param-"+u,type:"text",class:"aui-card-input","onUpdate:modelValue":m=>t.value[d.name]=m,placeholder:"è¯·è¾“å…¥"+d.name},null,8,X),[[e.vModelText,t.value[d.name]]])]))),128)):c.value.type==="journey"?(e.openBlock(),e.createElementBlock("div",G,[e.createElementVNode("div",Q,[o[3]||(o[3]=e.createElementVNode("label",{class:"aui-input-label"},"èµ·å§‹ä½ç½®",-1)),e.withDirectives(e.createElementVNode("input",{type:"text",class:"aui-card-input","onUpdate:modelValue":o[0]||(o[0]=d=>t.value[c.value.start||"start"]=d),placeholder:"è¯·è¾“å…¥èµ·å§‹ä½ç½®"},null,512),[[e.vModelText,t.value[c.value.start||"start"]]])]),o[5]||(o[5]=e.createElementVNode("div",{class:"aui-journey-arrow"},"â†“",-1)),e.createElementVNode("div",Z,[o[4]||(o[4]=e.createElementVNode("label",{class:"aui-input-label"},"ç›®çš„åœ°",-1)),e.withDirectives(e.createElementVNode("input",{type:"text",class:"aui-card-input","onUpdate:modelValue":o[1]||(o[1]=d=>t.value[c.value.end||"end"]=d),placeholder:"è¯·è¾“å…¥ç›®çš„åœ°"},null,512),[[e.vModelText,t.value[c.value.end||"end"]]])])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",{class:"aui-card-actions"},[e.createElementVNode("button",{class:"aui-card-confirm",onClick:b}," ç¡®å®š ")])],2))}},[["__scopeId","data-v-21017ea7"]]),k="http://localhost:8080",te=`${k}/loader.html`,ae=async(n,i)=>{try{return console.log(i),await ie(n,i)}catch(s){return console.error("LLM API error:",s),"Error: please retry later."}},oe=n=>{let i={};for(let r in n.methods)i[r]={},i[r].description=n.methods[r].description,i[r].params=n.methods[r].params;return`
  ä½ æ˜¯ä¸€ä¸ªåªè¾“å‡º JSON çš„ API æŽ¥å£ï¼Œä¸è¦è¾“å‡ºä»»ä½•è§£é‡Šæ€§æ–‡å­—,
  ä¸¥ç¦ä½¿ç”¨ \`\`\` ä»£ç å—åŒ…è£¹ï¼Œä¸¥ç¦åœ¨ JSON å‰åŽæ·»åŠ ä»»ä½•é—®å€™è¯­.
  è¯¥ç½‘ç«™çš„ä»‹ç»ä¸º${n.introduction};
  å¯ä¾›é€‰æ‹©çš„æ–¹æ³•ä¸º ${JSON.stringify(i)}
  ä½ è¾“å‡ºçš„jsonæ ¼å¼ä¸ºï¼š
  {
    "type": "method", // å¯ä»¥æ˜¯ method æˆ– text
    "method": "æ–¹æ³•å", //å½“typeä¸ºmethodæ—¶ï¼Œå¿…å¡«
    "arguments": { //å‚æ•°åå’Œå‚æ•°å€¼, è¯¥æ–¹æ³•æœ‰å‚æ•°æ—¶å¿…å¡«
      "å‚æ•°å": "å‚æ•°å€¼"
    },
    "text": "æ™®é€šæ–‡æœ¬å›žå¤" //å½“typeä¸ºtextæ—¶ï¼Œå¿…å¡«
  }
  ä½ å¯ä»¥æ ¹æ®ç”¨æˆ·çš„é—®é¢˜å’Œä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œé€‰æ‹©åˆé€‚çš„æ–¹æ³•æˆ–ç›´æŽ¥å›žå¤æ–‡æœ¬,ä½†å›žå¤æ–‡æœ¬ä¹Ÿå¿…é¡»ç¬¦åˆjsonæ ¼å¼
  `},ie=async(n,i)=>new Promise((s,r)=>{console.log("å¼€å§‹åˆ›å»º iframe è¯·æ±‚");const t=document.createElement("iframe");t.style.display="none",t.style.width="0px",t.style.height="0px",t.style.border="none",t.src=te;const c=f=>{if(f.origin!==k){console.log("æ¶ˆæ¯æ¥æºä¸åŒ¹é…ï¼Œå¿½ç•¥:",f.origin);return}const l=f.data;l.type==="response"&&(console.log("æ”¶åˆ°å“åº”:",l),window.removeEventListener("message",c),document.body.removeChild(t),l.success?s(l.content):r(new Error(l.content||"Request failed")))};window.addEventListener("message",c),t.onload=()=>{try{const f=oe(i);t.contentWindow.postMessage({type:"request",message:n,options:f,passKey:i.passKey},k)}catch(f){r(f),window.removeEventListener("message",c),document.body.removeChild(t)}},t.onerror=f=>{r(new Error("iframe loading failed")),window.removeEventListener("message",c),document.body.contains(t)&&document.body.removeChild(t)},document.body.appendChild(t),document.body.contains(t)||(console.error("iframe æœªèƒ½æˆåŠŸæ·»åŠ åˆ° DOM"),r(new Error("Failed to append iframe to DOM"))),setTimeout(()=>{console.log("è¯·æ±‚è¶…æ—¶"),window.removeEventListener("message",c),document.body.contains(t)&&document.body.removeChild(t),r(new Error("Request timeout"))},3e4)}),ne={class:"aui-main-container"},E=v({__name:"aui-main",props:{options:{type:Object,default:()=>({})}},setup(n){const i=n,s=e.ref(null),r=e.ref(!1);e.ref([]);const t=e.computed(()=>({icon:{path:i.options.icon?.path||"",width:i.options.icon?.width||32,height:i.options.icon?.height||32,position:i.options.icon?.position||"bottom-right",description:i.options.icon?.description||""},window:{width:i.options.window?.width||300,height:i.options.window?.height||400,position:i.options.window?.position||"bottom-right",description:i.options.window?.description||"",placeholder:i.options.window?.placeholder||""},description:i.options.description||"",methods:i.options.methods||{}})),c=()=>{r.value=!r.value},f=()=>{r.value=!1},l=async a=>{console.log("Received message:",a);const o=t.value.methods,d=await ae(a,i.options);if(typeof d=="object"&&s.value){const u=o[d.method],m=d.arguments||{};s.value.replyCard(u,m)}else s.value&&s.value.replyMessage(d)},g=(a,o)=>{console.log("Card confirmed:",a),b(a),o&&o(a)},b=a=>{const{method:o,params:d}=a;console.log("cardData:"),console.log(a),typeof o=="function"?o(...d||[]):typeof o=="string"&&o.startsWith("http")?window.location.href=o:console.error("Invalid method type:",o)};return e.onMounted(()=>{console.log("AUI initialized with config:",t.value)}),(a,o)=>(e.openBlock(),e.createElementBlock("div",ne,[e.createVNode(M,{"icon-config":t.value.icon,onClick:c},null,8,["icon-config"]),e.createVNode(W,{visible:r.value,"window-config":t.value.window,onClose:f,onSendMessage:l,ref_key:"winRef",ref:s},{card:e.withCtx(({card:d,onConfirm:u})=>[e.createVNode(ee,{"card-config":d,onConfirm:m=>g(m,u)},null,8,["card-config","onConfirm"])]),_:1},8,["visible","window-config"])]))}},[["__scopeId","data-v-37169f37"]]);class _{constructor(i={}){this.options=i,this.app=null,this.mount()}mount(){const i=document.createElement("div");i.id="aui-container",document.body.appendChild(i),this.app=e.createApp(E,{options:this.options}),this.app.mount("#aui-container")}show(){this.app&&this.app.config.globalProperties.$emit("show")}hide(){this.app&&this.app.config.globalProperties.$emit("hide")}}typeof window<"u"&&(window.AUI=_,window.AUI.AuiMain=E),x.AuiMain=E,x.default=_,Object.defineProperties(x,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})}));
